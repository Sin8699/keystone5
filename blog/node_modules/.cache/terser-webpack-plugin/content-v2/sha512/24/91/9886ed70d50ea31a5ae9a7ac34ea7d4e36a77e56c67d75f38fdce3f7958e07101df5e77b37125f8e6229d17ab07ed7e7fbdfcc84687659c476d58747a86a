{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{609:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"default\",function(){return y});var r=n(7),a=n(1),o=n(0),i=n(93),s=n(13),c=n(77),u=n(131),l=n(12),d=n(23),p=n(2);function f(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return!t||\"object\"!=typeof t&&\"function\"!=typeof t?function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),(n=h(this,v(t).call(this,e))).onCancel=function(){n.props.onChange(n.originalFile),n.setState({changeStatus:n.originalFile?\"stored\":\"empty\",dataURI:null,errorMessage:null})},n.onRemove=function(){n.setState({changeStatus:\"removed\",errorMessage:null}),n.props.onChange(null)},n.onChange=function(e){var t=e.target,r=t.validity,a=g(t.files,1)[0];if(a){var o=n.props,i=o.errorMessage,s=o.onChange,c={changeStatus:\"updated\"};r.valid?(a.type.includes(\"image\")?(n.getDataURI(a),c.oldImagePath=n.getImagePath()):n.state.dataURI&&n.setState({dataURI:null,errorMessage:null}),s(a),n.setState(c)):n.setState({errorMessage:i({type:\"save\"})})}},n.openFileBrowser=function(){n.inputRef&&n.inputRef.click()},n.getFile=function(){var e=n.props.value,t=\"removed\"===n.state.changeStatus?n.originalFile:e;return{file:t,type:t&&t.__typename?\"server\":\"client\"}},n.getDataURI=function(e){var t=n.props.errorMessage,r=new FileReader;r.readAsDataURL(e),r.onloadstart=function(){n.setState({isLoading:!0})},r.onerror=function(e){console.error(\"Error with Cloudinary preview\",e),n.setState({errorMessage:t({type:\"preview\"})})},r.onloadend=function(e){n.setState({isLoading:!1,dataURI:e.target.result})}},n.getImagePath=function(){var e=n.state.dataURI,t=n.getFile().file;return t&&t.mimetype&&t.mimetype.includes(\"image\")?t.publicUrl:e},n.getInputRef=function(e){n.inputRef=e},n.renderUploadButton=function(){var e=n.props.uploadButtonLabel,t=n.state,r=t.changeStatus,o=t.isLoading;return Object(a.c)(l.LoadingButton,{onClick:n.openFileBrowser,isLoading:o,variant:\"ghost\"},e({status:r}))},n.renderCancelButton=function(){var e=n.props.cancelButtonLabel,t=n.state.changeStatus,r=\"warning\",o=n.onRemove;switch(t){case\"removed\":r=\"primary\",o=n.onCancel;break;case\"updated\":o=n.onCancel}return Object(a.c)(l.Button,{onClick:o,variant:\"subtle\",appearance:r},e({status:t}))};var r=e.value;n.originalFile=r;var o=n.originalFile?\"stored\":\"empty\";return n.state={changeStatus:o,dataURI:null,errorMessage:null,isLoading:!1,oldImagePath:null},n}var n,r,s;return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,o[\"Component\"]),n=t,(r=[{key:\"render\",value:function(){var e=this.props,t=e.autoFocus,n=e.field,r=e.statusMessage,o=e.errors,s=this.state,u=s.changeStatus,l=s.errorMessage,f=this.getFile().file,g=this.getImagePath(),b=[\"removed\",\"updated\"].includes(u),h=\"ks-input-\".concat(n.path);return Object(a.c)(i.FieldContainer,null,Object(a.c)(i.FieldLabel,{htmlFor:h,field:n,errors:o}),n.config.adminDoc&&Object(a.c)(i.FieldDescription,null,n.config.adminDoc),Object(a.c)(i.FieldInput,null,f?Object(a.c)(j,null,g?Object(a.c)(C,{src:g,alt:n.path}):null,Object(a.c)(S,null,Object(a.c)(d.FlexGroup,{style:{marginBottom:p.gridSize}},this.renderUploadButton(),this.renderCancelButton()),l?Object(a.c)(I,null,l):Object(a.c)(d.FlexGroup,{isInline:!0,growIndexes:[0]},Object(a.c)(F,{href:f.publicUrl},f.filename||f.name),b?Object(a.c)(L,{status:u},r({status:u})):null))):this.renderUploadButton(),Object(a.c)(c.HiddenInput,{autoComplete:\"off\",autoFocus:t,id:h,innerRef:this.getInputRef,name:n.path,onChange:this.onChange,type:\"file\"})))}}])&&b(n.prototype,r),s&&b(n,s),t}();y.defaultProps={cancelButtonLabel:function(e){switch(e.status){case\"stored\":return\"Remove File\";case\"removed\":return\"Undo Remove\";case\"updated\":default:return\"Cancel\"}},errorMessage:function(e){switch(e.type){case\"save\":return\"Something went wrong, please reload and try again.\";case\"preview\":return\"Something went wrong, please try again.\"}},statusMessage:function(e){switch(e.status){case\"removed\":return\"save to remove\";case\"updated\":return\"save to upload\"}},uploadButtonLabel:function(e){return\"empty\"===e.status?\"Upload File\":\"Change File\"}};var O={name:\"12s080b\",styles:\"align-items:flex-start;display:flex;\"},j=function(e){return Object(a.c)(\"div\",Object.assign({css:O},e))},w={name:\"1fjtzvx\",styles:\"flex:1;min-width:0;\"},S=function(e){return Object(a.c)(\"div\",Object.assign({css:w},e))},R={name:\"1cnfvrz\",styles:\"height:auto;max-width:100%;\"},C=function(e){return Object(a.c)(\"div\",{css:Object(r.a)({backgroundColor:\"white\",borderRadius:p.borderRadius,border:\"1px solid \".concat(p.colors.N20),flexShrink:0,lineHeight:0,marginRight:p.gridSize,padding:4,position:\"relative\",textAlign:\"center\",width:130},\"\")},Object(a.c)(\"img\",Object.assign({css:R},e)))},F=function(e){return Object(a.c)(u.Lozenge,Object.assign({crop:\"right\"},e))},I=function(e){var t=e.children,n=f(e,[\"children\"]);return Object(a.c)(u.Lozenge,Object.assign({style:{backgroundColor:p.colors.R.L80,borderColor:\"transparent\",color:p.colors.R.D20,display:\"inline-flex\"}},n),Object(a.c)(s.AlertIcon,{css:Object(r.a)({marginRight:p.gridSize},\"\")}),t)},x={default:\"primary\",removed:\"danger\",updated:\"create\"},L=function(e){var t=e.status,n=void 0===t?\"default\":t,r=f(e,[\"status\"]),o=x[n];return Object(a.c)(u.Lozenge,Object.assign({appearance:o},r))}}}]);","extractedComments":[]}